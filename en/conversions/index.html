
<!DOCTYPE HTML>
<html lang="en" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Transformations Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    
    <link rel="prev" href="../security/permissions.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">Developer guide</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../getting-started.html">
            
                <a href="../getting-started.html">
            
                    
                    Getting Start
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../environments/">
            
                <a href="../environments/">
            
                    
                    Environments
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../workflow/">
            
                <a href="../workflow/">
            
                    
                    Workflow
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../workflow/testing/">
            
                <a href="../workflow/testing/">
            
                    
                    Tests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../workflow/docker/">
            
                <a href="../workflow/docker/">
            
                    
                    Docker
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../workflow/docker/docker-folders.html">
            
                <a href="../workflow/docker/docker-folders.html">
            
                    
                    The docker Folder
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="../workflow/docker/docker-usage.html">
            
                <a href="../workflow/docker/docker-usage.html">
            
                    
                    Docker Usage
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../workflow/travis.html">
            
                <a href="../workflow/travis.html">
            
                    
                    Travis CI
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../persistence/">
            
                <a href="../persistence/">
            
                    
                    Data Model
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../security/">
            
                <a href="../security/">
            
                    
                    Security and Access Control
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../security/authentication.html">
            
                <a href="../security/authentication.html">
            
                    
                    Authentication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../security/permissions.html">
            
                <a href="../security/permissions.html">
            
                    
                    Authorization
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="1.7" data-path="./">
            
                <a href="./">
            
                    
                    Transformations
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Transformations</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="data-format-conversions">Data Format Conversions</h1>
<p>Moving from one data format to another is one of the core features of Pogues. This transformations may be accomplished using XSL transformations, external API calls, a set of serializer or whatever future expectation may require. Transformations may be chained together as well as used separately.</p>
<p>To help will this, every transformation implementation will have to rely on a common interface, easing the process of chaining or swapping transformations all accross the application.</p>
<h2 id="the-transformer--interface">The Transformer  Interface</h2>
<p>Consequently, as soon as we need to implement a transformation we will implement the Transformer interface which defines a set of <code>transform</code> methods with different types of inputs and outputs.</p>
<pre><code class="lang-java"><span class="hljs-keyword">package</span> fr.insee.pogues.transforms;

<span class="hljs-keyword">import</span> java.io.InputStream;
<span class="hljs-keyword">import</span> java.io.OutputStream;
<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Transformer</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">transform</span><span class="hljs-params">(InputStream input, OutputStream output, Map&lt;String, Object&gt; params, String surveyName)</span>
            <span class="hljs-keyword">throws</span> Exception</span>;

    <span class="hljs-function">String <span class="hljs-title">transform</span><span class="hljs-params">(InputStream input, Map&lt;String, Object&gt; params, String surveyName)</span> <span class="hljs-keyword">throws</span> Exception</span>;

    <span class="hljs-function">String <span class="hljs-title">transform</span><span class="hljs-params">(String input, Map&lt;String, Object&gt; params, String surveyName)</span> <span class="hljs-keyword">throws</span> Exception</span>;

}
</code></pre>
<p>The params Map can be used to pass parameters along the transformation process that can be used by transformers to produce their output.</p>
<h2 id="the-transform-functional-interface">The transform functional interface</h2>
<p>To be able to use the Transformer interface methods using java 8 <a href="https://docs.oracle.com/javase/tutorial/java/javaOO/methodreferences.html" target="_blank">method references</a> we define a Functional Interface which every Transformer method will conform to:</p>
<pre><code class="lang-java">    <span class="hljs-meta">@FunctionalInterface</span>
    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Transform</span>&lt;<span class="hljs-title">I</span>, <span class="hljs-title">O</span>&gt; </span>{
        <span class="hljs-function">O <span class="hljs-title">apply</span><span class="hljs-params">(I i, Map&lt;String, Object&gt; params, String surveyName)</span> <span class="hljs-keyword">throws</span> Exception</span>;
    }
</code></pre>
<h2 id="the-pipeline-class">The Pipeline class</h2>
<p>The Pipeline class is where we can chain our transform methods together to set up a more complex transformation process.</p>
<p>For instance, visualization is accomplished using the Pipeline class and a the following transformer chain:</p>
<p><code>[Pogues JSON] -&gt; [Pogues XML] -&gt; [DDI] -&gt; [XForm] -&gt; [Form URI]</code></p>
<p>Here is what the code will look like:</p>
<pre><code class="lang-java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PipeSample</span></span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">pipe</span><span class="hljs-params">(HttpServletRequest request)</span></span>{
        <span class="hljs-keyword">return</span> pipeline
            .from(request.getInputStream())
            .map(jsonToXML::transform, params)
            .map(xmlToDDI::transform, params)
            .map(ddiToXForm::transform, params)
            .map(xformToUri::transform, params)
            .transform()
            .getBytes();
    }
}
</code></pre>
<p>Currently our very first implementation of the Pipeline class sticks to String inputs and String outputs.</p>
<p>Building a transformation chain begins with setting the input of the chain in the <code>from</code> method of the pipeline class (in the example we get our input from a request as a stream but input could be passed as well as a string argument).
Then we can chain transformers using the <code>map</code> method of the Pipeline. Both the from and the map method return the Pipeline instance, allowing us to chain call fluently.</p>
<p>Once we chained our Transformers we can then trigger the transformation process by calling transform on the pipeline. We have to notice that no transformation will be applied until we call this method.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../security/permissions.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Authorization">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Transformations","level":"1.7","depth":1,"previous":{"title":"Authorization","level":"1.6.2","depth":2,"path":"security/permissions.md","ref":"security/permissions.md","articles":[]},"dir":"ltr"},"config":{"plugins":["include-codeblock","sequence-diagrams"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"include-codeblock":{"check":false,"edit":false,"fixlang":false,"lang":"","template":"default","theme":"chrome","unindent":false},"sequence-diagrams":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"language":"en","gitbook":"*"},"file":{"path":"conversions/README.md","mtime":"2021-07-09T09:10:53.868Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-07-09T09:11:47.768Z"},"basePath":"..","book":{"language":"en"}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

